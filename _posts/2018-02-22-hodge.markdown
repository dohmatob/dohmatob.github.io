---
layout: post
title:  "Discrete De Rham-Hodge cohomology theory: application to game theory and statistical ranking (Part I)"
date:   2018-02-22 13:26
categories: research
images:

 - url: /assets/figures/ranking/hodge.png
 - alt: Sobolev regularization meets online DL
 - title: Sobolev regularization meets online DL

---

*Cohomology* is a central concept in algebraic topology and geometry. Oddly enough, this theory applies to certain *concrete* problems arising in machine learning (e.g globally consistent ranking of items in an online shop like Amazon or NetFlix) and game theory (e.g approximating multi-player non-cooperative games with potential games, in view of computing approximate Nash equilibria of the former).

Here we review these connections.

<img src="/assets/figures/ranking/hodge.png"/>

*(Figure is courtesy of Jiang et al. ["Statistical ranking and combinatorial Hodge theory"][6])*

## Prerequisites
The ideas presented here should be directly accessible to anyone with a some acquaintance with the
following elementary concepts (in decreasing order of importance)

- Algebra: sets, Abelian groups, vector spaces matrices / linear transformations, kernel, image, dual space, rank-nullity theorem

- Differential geometry: the idea of a smooth manifold, scalar and vector fields, differential forms, gradient, divergence, curl, Stokes theorem


## Some

That notwithstanding, as we go along I shall try my best to review some of these concepts in context, to the minimal amount of detail which is sufficient for my purposes.

{% include mathjax.html %}
$$
\def\im{\operatorname{im}}
\def\grad{\operatorname{grad}}
\def\curl{\operatorname{curl}}
\def\div{\operatorname{div}}
\def\dim{\operatorname{dim}}
$$

## A criminal's view on comohology
It is well known that on a smooth $n$-dimensional manifold $M$ (Def: $M$ is a *separable topological space* in which each point $x \in M$ has a neighborhood $U_x \ni x$ which is *diffeomorphic* to an open subset of $V_x$ of $\mathbb R^n$), a *conservative* vector field is *irrotational*, i.e 

$$\text{curl}(\underbrace{\text{grad}(f)}_{\text{conservative}}) = 0,
$$

for any smooth function $f: M \rightarrow \mathbb R$. Recall that $\operatorname{grad}(f) := \left(\frac{\partial f}{\partial x_1},\ldots,\frac{\partial f}{\partial x_n}\right) = \sum_{i}\frac{\partial f}{\partial x_i} dx_i$, a [differential $1$-form][4] on $M$. As regards the object "$dx_i$", it should be seen as a linear form on the tangent bundle, which returns the $i$th component of a (co-)vector, i.e $dx_i(a) = a_i$.


**Question (Q1):** Is the converse true ? That is if $F$ is a vector field with $\text{curl}(F) = 0$, is it true that $X = \grad(f)$, the gradient of some scalar potential field $f$ ?

#### Example of "global obstruction" to (Q1)
Let's produce an examplar scenario where **(Q1)** might not have an affirmative answer. Let $M = \mathbb R - \\{(0,0)\\}$, i.e the plane with the origin removed, and consider the vector field defined on $M$ by $F(x, y) := \left(-\frac{y}{x^2 + y^2}, \frac{x}{x^2 + y^2}\right)$. By [Stocke's Theorem][3], it is clear that the flux of $F$ along every closed loop which goes clockwise around the origin once is non-zero. This is because $F(x, y)$ is always a tangent at $(x, y)$, and points clockwise. However, a direct computation shows that $\text{curl}(F) = 0$.


#### Cohomological reformulation of (Q1)
In question **(Q1)**, ultimately, the interesting problem is the estimation of the size of the  group

$$
 \dfrac{\text{ker}(\text{curl})}{\text{im}(\text{grad})} := \{X + \text{im}(\text{grad}) | \text{curl}(X) = 0\}.
$$

Let's denote this  group $H^1(M, \mathbb R)$.
If $\|H^1(M, \mathbb R)\| = 1$ so that $H^1(M, \mathbb R) = \\{ 0 \\}$ and $\text{ker}(\text{curl}) = \text{im}(\text{grad})$, then the answer to the above question **(Q1)** is affirmative. Thus $H^1(M, \mathbb R)$  measures the "obstruction" to answering **(Q1)** affirmatively. The "$H$" in $H^1(M, \mathbb R)$ stands for *homology* in co-*homology*, a concept which we will now explore.


The [De Rham co-chain complexe][1] of $M$ is the chain

$$
0 \longrightarrow \Omega^0(M) \overset{d^1=\operatorname{grad}}{\longrightarrow} \Omega^1(M) \overset{d^2=\operatorname{curl}}{\longrightarrow} \Omega^2(M) \overset{d^3}{\longrightarrow} \ldots \Omega^{k-1}(M) \overset{d^k}{\longrightarrow} \Omega^{k}(M) \ldots \overset{d^n}{\longrightarrow} \Omega^n(M) \longrightarrow 0.
$$

Here, $\Omega^k(M)$ denotes the vector space of all [differential $k$-forms][4] on $M$. It is the span of $k$-fold *Wedge products* of the form $dx_{i_1} \wedge \ldots \wedge dx_{i_k}$ whose coefficients are smooth functions on $M$. This has the structure of a $\mathcal C^\infty$-module of rank $\mathcal C^\infty(M)$, the ring of smooth functions on $M$. It's not hard to see that  $\Omega^k(M)$ is a module over $\mathcal C^\infty(M)$, and has rank ${n\choose k}$. This explains why the co-chain complexe drawn above is finite: the endpoints are trivial via since the wedge product of an empty set or a set of more than $n$ differential $1$-forms on in $n$ dimensions is zero. Also, since ${n\choose n-k} = {n\choose k}$, it follows that $\Omega^k \cong \Omega^{n-k}$ as $\mathcal C^\infty(M)$-modules.

The symbol $d^k$ is the restriction on $\Omega^k(M)$ of the [exterior derivative][5] $d$ of the manifold $M$. All we need to know here is that $d$ is a function defined on the exterior *graduated algebra* $\Omega(M) := \oplus_k \Omega^k(M)$ and is constrained to uniquely satisfy many properties, the most important being $d \circ d = 0$.
This in turn implies that $d^{k+1} \circ d^k = 0$, i.e $\im(d^k)$ is a subspace of $\ker(d^{k+1})$ for all $k$, which is nothing but an exotic higher-order reformulation of the principle we saw in the of this post, namely that every conservative vector field is irrotational!

One may now form the group

$$
H^k(M,\mathbb R) := \dfrac{\operatorname{ker}(d^{k+1})}{\operatorname{im}(d^k)},
$$

called the $k$th De Rham cohomology of $M$. Amongst many other fabulous predictions, one can show that if $M$ and $M'$ are of same "homotopy type" (e.g the whole of $\mathbb R^n$ has the same homotopy type as any point in it! Two smooth curves with the same endpoints have the same homotopy type. And so on...), then they have the same cohomology.

In this new parlance, one restate **(Q1)** as asking whether the 1st De cohomology

$$
H^1(M, \mathbb R) := \dfrac{\operatorname{ker}(d^2)}{\operatorname{im}(d^1)} = \dfrac{\operatorname{ker}(\operatorname{curl})}{\operatorname{im}(\operatorname{grad})}
$$

of $M$ is trivial. Of course, the answer depends on the global geometry of $M$. Indeed, if $M$ is flat (i.e $M$ is *homotopy equivalent* to $\mathbb R^n$, denoted $M \simeq \mathbb R^n$), then the answer is affirmative because $\mathbb R^n \simeq \\{0\\}$, and so has the same cohomology (up to withing group isomorphism). It follows in particular that

$$
H^k(M,\mathbb R) \cong H^k(\mathbb R^n,\mathbb R) \cong H^k(\{0\},\mathbb R) \cong
\begin{cases}
\mathbb R,&\mbox{ if }n > 0,\; k = 0,\\ \{0\},&\mbox{ else.}
\end{cases}
$$

Since a smooth manifold is locally flat, it then follows that the answer to **(Q1)** is affirmative, locally, without any restrictions on $M$. This is precisely the [Poincaré Lemma][2]: every irrotational vector field is locally conservative! <!-- For example, $H^1(\mathbb R^2) = 0$ while $H^1(\mathbb R^2-\{(0,0)\}) \cong \mathbb R$, since the vector field $(x, y) \mapsto \left(-\frac{y}{x^2+y^2},\frac{x}{x^2  + y^2}\right)$ defined on the punctured plane $\mathbb R^2-\{(0,0)\}$ is non-conservative (use Stockes theorem) and irrotational (direct computation). -->
  

### Some "computations"
To wrap up this introductory section, let's note the following algebraic topological facts about the De Rham comohology:

- *(1)* $H^0(M, \mathbb R) = \ker(\grad)/\\{0\\} = \ker(\grad) \cong \mathbb R^c$, where $c$ is the number of "topologically connected components" of $M$.

<!-- - *(2)* $\operatorname{dim} H^k(M, \mathbb R) = \;"\text{number of order-}$k$ \text{ topological connected components }M$" -->

- *(2)* If $M$ is compact and *orientable*, then $H^n(M, \mathbb R)$ is non-trivial, i.e $\dim H^n(M, \mathbb R) \ge 1$.

### The Hodge decomposition
We now see how to "compress" a manifold via linear algebra.
If $M$ is Riemannian, so that it has a metric, then for each $k$ we can define a (generalized) *divergence* operator, $\delta_k: \Omega^k(M) \rightarrow \Omega^{k-1}$ by
$\langle \delta_k X, f \rangle_{\Omega^{k-1}(M)} = \langle X, d^k(f)\rangle_{\Omega^k(M)},
$
which is the adjoint of $d^k$. We can then define the generalized *Hermoltzian* (aka *Laplacian*) of $M$, namely the *elliptic* differential operator

$$
\Delta_k := d^k \delta_k + \delta_{k+1}d^{k+1} : \Omega^k(M) \rightarrow \Omega^k(M),
$$

whose kernel is the space of *harmonic* functions

$$
\mathcal H^k(M,\mathbb R) := \operatorname{ker}(\Delta_k).
$$


**Theorem (Hodge decomposition).**

- *(a) We have the group isomorphism*

$$
\mathcal H^k(M,\mathbb R) \cong \ker(\delta_k) \cap \ker(d^{k + 1}).
$$

- *(b) If  $M$ is compact, then $H^k(M,\mathbb R) \cong \mathcal H^k(M,\mathbb R)$, and we have the  decomposition*

\begin{equation}
\Omega^k(M) = \im(d^{k-1}) \oplus \mathcal H^k(M,\mathbb R) \oplus \im(\delta_k).
\end{equation}

*Sketch of proof.* Soit $A$, $B$ des matrices avec $AB = 0$.  Soit la matrice $\Delta := A^* A + BB^* $, matrice psd d'ordre $n$ dont on peut montrer que son noyeau vaut $\ker(\Delta) = \ker(A^* ) \cap \ker(B)$, qui est biensur isomorphe au groupe  $H^1 :=\ker(A)/\im(B)$. Par le theoreme de décomposition de Fredholm (algèbre liniaire élementaire) et le fait que $\Delta^* = \Delta$, l'on a

$$
\mathbb R^n = \ker(\Delta) \oplus \ker(\Delta)^\perp = \ker(\Delta) \oplus \im(\Delta) = H^1 \oplus \im(A^* ) \oplus \im(B).
$$

Il suffit alors the prendre $A = d^{k+1}$ et $B = d^k$ pour obtenir l'annoncé. $\quad\quad\quad\quad\quad\quad\quad\quad\quad\Box$

## Next time
In the next post we shall construct de De Rham cohomology and Hodge decomposition of an abstract simplicial complex, and apply it to ranking (obtaining the so-called [HodgeRank][6]) and game theory.


  [1]: https://en.wikipedia.org/wiki/De_Rham_cohomology
  [2]: https://en.wikipedia.org/wiki/Closed_and_exact_differential_forms#Poincaré_lemma
  [3]: https://en.wikipedia.org/wiki/Stokes%27_theorem
  [4]: https://fr.wikipedia.org/wiki/Forme_diff%C3%A9rentielle
  [5]: https://fr.wikipedia.org/wiki/Forme_diff%C3%A9rentielle#Dérivée_extérieure
  [6]: https://link.springer.com/article/10.1007/s10107-010-0419-x
